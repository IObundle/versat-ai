# versat-ai

A Python program that generates a hardware-accelerated inference runtime from an ONNX model. Both the hardware and the software that drives it are generated automatically, meaning that we are essentially making a Model -> Runtime compiler. The runtime is intended to run in an embedded system and be accelerated by a custom accelerator generated by Versat, a CGRA compiler.

# Current state of the project

Currently the project is in a very unstable initial stage. Files and folder structures are volatile and will change in the future. The current code is capable of extracting useful info from an ONNX model and generating the barebones structure of the runtime and the necessary code to test the implementation, but currently no operator is fully supported in software and no hardware is currently being generated (Versat is still yet to be integrated).

The current high-level priorities of the project are, in order:

- Implement a custom tester that correctly reports how many different operator configurations are being properly tested.
- Implement a simple software-only runtime (to test the correctness and to calculate the speedup of the generated hardware).
- Integrate Versat and implement the ONNX operators using the generated accelerator.
- (Optionally) - Either integrate open-source or implement tools that optimize models for inference (apply optimizations like folding batch normalization layers into convolutional layers, among other optimizations)

# Running

Currently the project is very barebones, but it is possible to generate and test a simple software only runtime (although some operators are not implemented).

Tests need to be downloaded separately, and a Python virtual environment needs to be set up beforehand.

The full list of commands is:
```bash
./downloadTests.sh           # Downloads the tests and unpacks them and prepares them for comsuption
./init.sh                    # Initializes Python virtual environment
source ./python/bin/activate # Activates Python virtual environment
make test                    # Runs the test
```

# Acknowledgement

This project was funded through the NGI0 Core Fund, a fund established by NLnet with financial support from the European Commission's Next Generation Internet programme, under the aegis of DG Communications Networks, Content and Technology under grant agreement No 101092990.

<table>
    <tr>
        <td align="center" width="50%"><img src="https://nlnet.nl/logo/banner.svg" alt="NLnet foundation logo" style="width:90%"></td>
        <td align="center"><img src="https://nlnet.nl/image/logos/NGI0Core_tag.svg" alt="NGI0 Core logo" style="width:90%"></td>
    </tr>
</table>